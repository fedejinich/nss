{
  "generated_at": "2026-02-16T22:33:19+00:00",
  "binary": "SoulseekQt",
  "architecture": "arm64",
  "sources": {
    "symbols": "/Users/void/Projects/nss/evidence/reverse/search_download_symbols_nm.txt",
    "strings": "evidence/reverse/search_download_strings.txt"
  },
  "nodes": [
    {
      "node_id": "server_prepare_search",
      "symbol": "Server::PrepareSearch(QString)",
      "address": "0x00000001000615c0",
      "stage": "server_tx",
      "description": "Normalizes search text before serialization.",
      "disassembly": "evidence/reverse/disasm/server_prepare_search.txt"
    },
    {
      "node_id": "server_file_search",
      "symbol": "Server::FileSearch(QString, QString)",
      "address": "0x0000000100060fa0",
      "stage": "server_tx",
      "description": "Builds and sends search message to the server.",
      "disassembly": "evidence/reverse/disasm/server_file_search.txt"
    },
    {
      "node_id": "server_send_message",
      "symbol": "Server::SendMessage(MemStream&, bool)",
      "address": "0x0000000100054dac",
      "stage": "server_tx",
      "description": "Serializes MemStream into the server socket.",
      "disassembly": "evidence/reverse/disasm/server_send_message.txt"
    },
    {
      "node_id": "server_handle_message",
      "symbol": "Server::HandleMessage(int, MemStream&)",
      "address": "0x000000010005521c",
      "stage": "server_rx",
      "description": "Dispatches incoming server messages.",
      "disassembly": "evidence/reverse/disasm/server_handle_message.txt"
    },
    {
      "node_id": "peer_queue_download",
      "symbol": "PeerMessenger::QueueDownload(QString, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>)",
      "address": "0x00000001000a4474",
      "stage": "peer_tx",
      "description": "Builds the initial download request sent to a peer.",
      "disassembly": "evidence/reverse/disasm/peer_queue_download.txt"
    },
    {
      "node_id": "peer_send_message",
      "symbol": "PeerMessenger::SendMessage(QTcpSocket*, MemStream&, bool)",
      "address": "0x00000001000a0328",
      "stage": "peer_tx",
      "description": "Serializes messages on the peer socket.",
      "disassembly": "evidence/reverse/disasm/peer_send_message.txt"
    },
    {
      "node_id": "peer_handle_message",
      "symbol": "PeerMessenger::HandleMessage(QTcpSocket*, MemStream)",
      "address": "0x00000001000964ec",
      "stage": "peer_rx",
      "description": "Dispatches incoming peer messages to transfer handlers.",
      "disassembly": "evidence/reverse/disasm/peer_handle_message.txt"
    },
    {
      "node_id": "transfer_on_queue_download",
      "symbol": "TransferQueueManager::OnQueueDownloadRequested(QString, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, long long)",
      "address": "0x00000001000f0478",
      "stage": "transfer_ctrl",
      "description": "Creates local queue entry and starts file connection flow.",
      "disassembly": "evidence/reverse/disasm/transfer_on_queue_download.txt"
    },
    {
      "node_id": "transfer_on_file_request",
      "symbol": "TransferQueueManager::OnFileTransferRequest(QString, int, unsigned int, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, long long)",
      "address": "0x00000001000d7114",
      "stage": "transfer_ctrl",
      "description": "Negotiates transfer request/response with peer.",
      "disassembly": "evidence/reverse/disasm/transfer_on_file_request.txt"
    },
    {
      "node_id": "download_read_socket",
      "symbol": "DownloadTask::readSocket()",
      "address": "0x00000001000eb9fc",
      "stage": "download_rx",
      "description": "Consumes socket bytes and writes destination file.",
      "disassembly": "evidence/reverse/disasm/download_read_socket.txt"
    },
    {
      "node_id": "upload_write_socket",
      "symbol": "UploadTask::writeToSocket()",
      "address": "0x00000001000ea3cc",
      "stage": "upload_tx",
      "description": "Streams local bytes to the remote peer.",
      "disassembly": "evidence/reverse/disasm/upload_write_socket.txt"
    }
  ],
  "edges": [
    {
      "from_id": "server_file_search",
      "to_id": "server_prepare_search",
      "reason": "file_search prepares terms before frame build"
    },
    {
      "from_id": "server_file_search",
      "to_id": "server_send_message",
      "reason": "file_search ends in send_message"
    },
    {
      "from_id": "server_send_message",
      "to_id": "server_handle_message",
      "reason": "request/response over server socket"
    },
    {
      "from_id": "peer_queue_download",
      "to_id": "transfer_on_queue_download",
      "reason": "queue_download creates transfer queue entry"
    },
    {
      "from_id": "transfer_on_queue_download",
      "to_id": "peer_send_message",
      "reason": "download queue emits request to peer"
    },
    {
      "from_id": "peer_send_message",
      "to_id": "peer_handle_message",
      "reason": "peer response returns through handle_message"
    },
    {
      "from_id": "peer_handle_message",
      "to_id": "transfer_on_file_request",
      "reason": "transfer_request dispatch"
    },
    {
      "from_id": "transfer_on_file_request",
      "to_id": "download_read_socket",
      "reason": "accepted request starts download"
    },
    {
      "from_id": "transfer_on_file_request",
      "to_id": "upload_write_socket",
      "reason": "accepted request may start upload"
    }
  ]
}
