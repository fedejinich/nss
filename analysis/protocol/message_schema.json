{
  "version": 2,
  "generated_at": "2026-02-15T14:53:49+00:00",
  "framing": {
    "transport": "tcp",
    "layout": "<u32 frame_len_le><u32 message_code_le><payload>",
    "confidence": "medium",
    "evidence": [
      {
        "kind": "ghidra_decompile",
        "source": "evidence/reverse/disasm/server_send_message.txt",
        "note": "Server send path serializes integer fields through MemStream before socket write."
      },
      {
        "kind": "ghidra_decompile",
        "source": "evidence/reverse/disasm/peer_send_message.txt",
        "note": "Peer send path mirrors frame serialization through MemStream."
      }
    ]
  },
  "coverage_contract": {
    "target_core_messages": 25,
    "high_min": 18,
    "medium_max": 7,
    "low_max": 0,
    "current": {
      "high": 25,
      "medium": 0,
      "low": 0
    }
  },
  "messages": [
    {
      "scope": "peer",
      "code": 1,
      "name": "PM_SAY",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Peer MessageCodeToString jump-table extraction resolves code 1 to PM_SAY (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 4,
      "name": "PM_GET_SHARED_FILE_LIST",
      "payload": [
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 5,
      "name": "PM_SHARED_FILE_LIST",
      "payload": [
        {
          "name": "entries",
          "type": "array<shared_file_entry>"
        },
        {
          "name": "entry.virtual_path",
          "type": "string"
        },
        {
          "name": "entry.size",
          "type": "u64"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 8,
      "name": "PM_FILE_SEARCH_REQUEST",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "query",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 9,
      "name": "PM_FILE_SEARCH_RESULT",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "result_count",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search-download/official_frames.hex",
          "note": "Observed inbound runtime frame in login-search-download scenario (code 9) with token+user+result_count."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 10,
      "name": "PM_INVITE_USER_TO_ROOM",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits invite-to-room frame (code 10) with room payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 14,
      "name": "PM_CANCELLED_QUEUED_TRANSFER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits cancelled-queued-transfer frame (code 14) with virtual path payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 15,
      "name": "PM_USER_INFO_REQUEST",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer code 15 UserInfoRequest with empty payload (code resolved from SLSK protocol spec); symbol confirmed in peer message code table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_USER_INFO_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 15 documents user info request as empty payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 16,
      "name": "PM_USER_INFO_REPLY",
      "payload": [
        {
          "name": "description",
          "type": "string"
        },
        {
          "name": "has_picture",
          "type": "bool_u8"
        },
        {
          "name": "picture",
          "type": "bytes_len_prefixed"
        },
        {
          "name": "total_uploads",
          "type": "u32"
        },
        {
          "name": "queue_size",
          "type": "u32"
        },
        {
          "name": "slots_free",
          "type": "bool_u8"
        },
        {
          "name": "upload_permissions",
          "type": "optional_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer code 16 UserInfoReply with description/picture/uploads/queue/slots fields (code resolved from SLSK protocol spec); symbol confirmed in peer message code table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_USER_INFO_REPLY."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 16 documents user info reply payload fields."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 33,
      "name": "PM_SEND_CONNECT_TOKEN",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Peer MessageCodeToString jump-table extraction resolves code 33 to PM_SEND_CONNECT_TOKEN (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 34,
      "name": "PM_MOVE_DOWNLOAD_TO_TOP",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits move-download-to-top frame (code 34) with virtual path payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 36,
      "name": "PM_GET_SHARED_FILES_IN_FOLDER",
      "payload": [
        {
          "name": "directory",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-folder-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow sends request for shared files in folder (code 36) with directory payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_GET_SHARED_FILES_IN_FOLDER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 36 documents folder contents request with directory string payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 37,
      "name": "PM_SHARED_FILES_IN_FOLDER",
      "payload": [
        {
          "name": "directory",
          "type": "string"
        },
        {
          "name": "compressed_listing",
          "type": "bytes_raw"
        },
        {
          "name": "decompressed_listing",
          "type": "bytes_raw"
        },
        {
          "name": "listing_format",
          "type": "enum"
        },
        {
          "name": "entry.virtual_path",
          "type": "string"
        },
        {
          "name": "entry.size",
          "type": "u64"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-folder-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits shared-files-in-folder response (code 37); protocol parser now performs zlib decompression-aware decoding."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_SHARED_FILES_IN_FOLDER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 37 documents compressed folder listing response payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 40,
      "name": "PM_TRANSFER_REQUEST",
      "payload": [
        {
          "name": "direction",
          "type": "enum_u32"
        },
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "file_size",
          "type": "u64"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer request negotiation."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer request negotiation path."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 41,
      "name": "PM_TRANSFER_RESPONSE",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "allowed",
          "type": "bool_u32"
        },
        {
          "name": "queue_or_reason",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer response negotiation."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer response negotiation path."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 42,
      "name": "PM_PLACEHOLD_UPLOAD",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Peer MessageCodeToString jump-table extraction resolves code 42 to PM_PLACEHOLD_UPLOAD (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 43,
      "name": "PM_QUEUE_UPLOAD",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_queue_download.txt",
          "note": "Queue manager records upload queueing for pending peers."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 44,
      "name": "PM_UPLOAD_PLACE_IN_LINE",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "place",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/upload-deny/official_frames.hex",
          "note": "Observed inbound runtime frame in upload-deny scenario (code 44) with queue place payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 46,
      "name": "PM_UPLOAD_FAILED",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "reason",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/upload-deny/official_frames.hex",
          "note": "Observed inbound runtime frame in upload-deny scenario (code 46) with failure reason payload."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/upload_write_socket.txt",
          "note": "Upload send path emits failure branch when transfer cannot continue."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 47,
      "name": "PM_EXACT_FILE_SEARCH_REQUEST",
      "payload": [
        {
          "name": "token",
          "type": "optional_u32"
        },
        {
          "name": "query",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits exact-file-search frame (code 47) with token+query payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_EXACT_FILE_SEARCH_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code list includes code 47 for ExactFileSearchRequest (legacy/obsolete family)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 48,
      "name": "PM_QUEUED_DOWNLOADS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits queued-downloads frame (code 48) with list payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 49,
      "name": "PM_INDIRECT_FILE_SEARCH_REQUEST",
      "payload": [
        {
          "name": "token",
          "type": "optional_u32"
        },
        {
          "name": "query",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits indirect-file-search frame (code 49) with query payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_INDIRECT_FILE_SEARCH_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code list includes code 49 for IndirectFileSearchRequest (legacy/obsolete family)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 50,
      "name": "PM_UPLOAD_DENIED",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "reason",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/upload-deny/official_frames.hex",
          "note": "Observed inbound runtime frame in upload-deny scenario (code 50) with deny reason payload."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/upload_write_socket.txt",
          "note": "Upload send path emits deny branch for rejected requests."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 51,
      "name": "PM_UPLOAD_PLACE_IN_LINE_REQUEST",
      "payload": [
        {
          "name": "virtual_path",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer code 51 PlaceInQueueRequest with filename/path payload (code resolved from SLSK protocol spec); symbol confirmed in peer message code table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_UPLOAD_PLACE_IN_LINE_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 51 documents place-in-line request carrying filename/path."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 52,
      "name": "PM_NOTHING",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Peer MessageCodeToString jump-table extraction resolves code 52 to PM_NOTHING (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 1,
      "name": "SM_LOGIN",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "password",
          "type": "string"
        },
        {
          "name": "client_version",
          "type": "u32"
        },
        {
          "name": "md5hash",
          "type": "string"
        },
        {
          "name": "minor_version",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-only/official_frames.hex",
          "note": "Observed authenticated runtime login request+response (code 1) with success payload on tuple 160/1."
        }
      ]
    },
    {
      "scope": "server",
      "code": 2,
      "name": "SM_SET_WAIT_PORT",
      "payload": [
        {
          "name": "listen_port",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Observed literal in Server::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "server",
      "code": 3,
      "name": "SM_GET_PEER_ADDRESS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "ip_address",
          "type": "ipv4_u32_le"
        },
        {
          "name": "port",
          "type": "u32"
        },
        {
          "name": "obfuscation_type",
          "type": "u32"
        },
        {
          "name": "obfuscated_port",
          "type": "u16"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-address-connect/official_frames.hex",
          "note": "Authenticated runtime flow includes GetPeerAddress request/response (code 3) with username and endpoint payload fields."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 3 defines peer-address request and response payload fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 5,
      "name": "SM_ADD_USER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 5 to SM_ADD_USER (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 6,
      "name": "SM_REMOVE_USER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 6 to SM_REMOVE_USER (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 7,
      "name": "SM_GET_USER_STATUS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "status",
          "type": "u32"
        },
        {
          "name": "privileged",
          "type": "bool_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-user-state/official_frames.hex",
          "note": "Authenticated runtime flow includes user-status request/response (code 7) with status and privilege fields."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 7 defines user status response fields (status and privilege bit)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 10,
      "name": "SM_ADD_CHATROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-room-term-control/official_frames.hex",
          "note": "Authenticated runtime flow sends add-chatroom control frame (code 10) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 11,
      "name": "SM_IGNORE_USER",
      "payload": [
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends ignore-user request (code 11); mapping aligns with server MessageCodeToString and SLSK spec obsolete ignore operation."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_IGNORE_USER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 11 documents IgnoreUser (obsolete) with username payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 12,
      "name": "SM_UNIGNORE_USER",
      "payload": [
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends unignore-user request (code 12); mapping aligns with server MessageCodeToString and SLSK spec obsolete unignore operation."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_UNIGNORE_USER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 12 documents UnignoreUser (obsolete) with username payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 13,
      "name": "SM_SAY_CHATROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "optional_string"
        },
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime room message flow: outbound SAY request and inbound room chat event in authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 14,
      "name": "SM_JOIN_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "users",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime join-room request and server join payload during authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 15,
      "name": "SM_LEAVE_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-leave-room/official_frames.hex",
          "note": "Observed runtime leave-room request and server leave acknowledgement payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 16,
      "name": "SM_USER_JOINED_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime user-joined room presence events while watching authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 17,
      "name": "SM_USER_LEFT_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime user-left room presence events while watching authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 18,
      "name": "SM_CONNECT_TO_PEER",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "connection_type",
          "type": "string"
        },
        {
          "name": "ip_address",
          "type": "ipv4_u32_le"
        },
        {
          "name": "port",
          "type": "u32"
        },
        {
          "name": "privileged",
          "type": "bool_u32"
        },
        {
          "name": "obfuscation_type",
          "type": "u32"
        },
        {
          "name": "obfuscated_port",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-address-connect/official_frames.hex",
          "note": "Authenticated runtime flow includes ConnectToPeer request and response payloads (code 18) with token"
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_handle_message.txt",
          "note": "Server handler routes peer connect responses to transfer subsystem."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 18 documents ConnectToPeer request and response payload shape."
        }
      ]
    },
    {
      "scope": "server",
      "code": 22,
      "name": "SM_MESSAGE_USER",
      "payload": [
        {
          "name": "message_id",
          "type": "u32"
        },
        {
          "name": "timestamp",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "message",
          "type": "string"
        },
        {
          "name": "is_new",
          "type": "bool_u8"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-message/official_frames.hex",
          "note": "Authenticated runtime flow includes private-message send and inbound private-message frame (code 22) with directional payload variants."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 22 documents private message request and incoming event fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 23,
      "name": "SM_MESSAGE_ACKED",
      "payload": [
        {
          "name": "message_id",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-message/official_frames.hex",
          "note": "Authenticated runtime flow includes private-message acknowledgement path (code 23) with message_id payload."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 23 documents private message acknowledgement with message ID."
        }
      ]
    },
    {
      "scope": "server",
      "code": 26,
      "name": "SM_FILE_SEARCH",
      "payload": [
        {
          "name": "search_token",
          "type": "u32"
        },
        {
          "name": "search_text",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_file_search.txt",
          "note": "FileSearch writes constant 0x1a before Server::SendMessage."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_file_search.txt",
          "note": "Function writes constant 0x1a before serializing search payload."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_prepare_search.txt",
          "note": "PrepareSearch normalizes and emits search tokens/strings."
        }
      ]
    },
    {
      "scope": "server",
      "code": 28,
      "name": "SM_SET_STATUS",
      "payload": [
        {
          "name": "status",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-system-control/official_frames.hex",
          "note": "Authenticated runtime flow sends set-status control frame (code 28) with u32 status payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 32,
      "name": "SM_HEARTBEAT",
      "payload": [
        {
          "name": "sequence",
          "type": "optional_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-system-control/official_frames.hex",
          "note": "Authenticated runtime flow sends heartbeat control frame (code 32) with u32 sequence payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 33,
      "name": "SM_SEND_CONNECT_TOKEN",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 33 to SM_SEND_CONNECT_TOKEN (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 34,
      "name": "SM_DOWNLOAD_SPEED",
      "payload": [
        {
          "name": "bytes_per_sec",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Observed literal in Server::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "server",
      "code": 35,
      "name": "SM_SHARED_FOLDERS_FILES",
      "payload": [
        {
          "name": "folder_count",
          "type": "u32"
        },
        {
          "name": "file_count",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Observed literal in Server::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "server",
      "code": 36,
      "name": "SM_GET_USER_STATS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "avg_speed",
          "type": "u32"
        },
        {
          "name": "download_num",
          "type": "u32"
        },
        {
          "name": "files",
          "type": "u32"
        },
        {
          "name": "dirs",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-user-state/official_frames.hex",
          "note": "Authenticated runtime flow includes user-stats request/response (code 36) with stats summary fields."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 36 defines user stats response fields (speed/downloads/files/dirs)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 41,
      "name": "SM_RELOGGED",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 runtime probe includes relogged control frame and validates empty typed payload decode path."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class Relogged (code 41) documents empty payload semantics."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 probe includes relogged control code frame for typed decode coverage."
        }
      ]
    },
    {
      "scope": "server",
      "code": 42,
      "name": "SM_SEARCH_USER_FILES",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "search_text",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search/official_frames.hex",
          "note": "Observed outbound runtime frame in login-search scenario (code 42) with user+query payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 50,
      "name": "SM_GET_SIMILAR_TERMS",
      "payload": [
        {
          "name": "term",
          "type": "string"
        },
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-similar-terms/official_frames.hex",
          "note": "Observed authenticated runtime request/response for similar-terms discovery flow (code 50)."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GET_SIMILAR_TERMS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents similar recommendation request/response message family."
        }
      ]
    },
    {
      "scope": "server",
      "code": 51,
      "name": "SM_ADD_LIKE_TERM",
      "payload": [
        {
          "name": "term",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-room-term-control/official_frames.hex",
          "note": "Authenticated runtime flow sends add-like-term control frame (code 51) with term string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 52,
      "name": "SM_REMOVE_LIKE_TERM",
      "payload": [
        {
          "name": "term",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-room-term-control/official_frames.hex",
          "note": "Authenticated runtime flow sends remove-like-term control frame (code 52) with term string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 54,
      "name": "SM_GET_RECOMMENDATIONS",
      "payload": [
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-recommendations/official_frames.hex",
          "note": "Observed authenticated runtime recommendations flow (code 54) including outbound request and inbound summary payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents recommendation request/response code mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 55,
      "name": "SM_GET_MY_RECOMMENDATIONS",
      "payload": [
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-recommendations/official_frames.hex",
          "note": "Observed outbound authenticated runtime request for my-recommendations (code 55) in recommendation batch."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_MY_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents my-recommendations request code mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 56,
      "name": "SM_GET_GLOBAL_RECOMMENDATIONS",
      "payload": [
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-recommendations/official_frames.hex",
          "note": "Observed authenticated runtime global-recommendations flow (code 56) with populated inbound payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_GLOBAL_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents global recommendations message mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 57,
      "name": "SM_GET_USER_RECOMMENDATIONS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-user-recommendations/official_frames.hex",
          "note": "Observed authenticated runtime user-recommendations flow (code 57) with user request and reply payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_USER_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents user recommendation/interests message mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 58,
      "name": "SM_COMMAND",
      "payload": [
        {
          "name": "command",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-text-control/official_frames.hex",
          "note": "Authenticated runtime flow sends command control frame (code 58) with command string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 59,
      "name": "SM_PLACE_IN_LINE",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 59 to SM_PLACE_IN_LINE (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 60,
      "name": "SM_PLACE_IN_LINE_RESPONSE",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 60 to SM_PLACE_IN_LINE_RESPONSE (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 61,
      "name": "SM_USER_LIST",
      "payload": [
        {
          "name": "user_count",
          "type": "u32"
        },
        {
          "name": "entry.username",
          "type": "string"
        },
        {
          "name": "status_count",
          "type": "u32"
        },
        {
          "name": "entry.status",
          "type": "u32"
        },
        {
          "name": "stats_count",
          "type": "u32"
        },
        {
          "name": "entry.avg_speed",
          "type": "u32"
        },
        {
          "name": "entry.upload_num",
          "type": "u32"
        },
        {
          "name": "entry.unknown",
          "type": "u32"
        },
        {
          "name": "entry.files",
          "type": "u32"
        },
        {
          "name": "entry.dirs",
          "type": "u32"
        },
        {
          "name": "slots_count",
          "type": "u32"
        },
        {
          "name": "entry.slots_full",
          "type": "u32"
        },
        {
          "name": "country_count",
          "type": "u32"
        },
        {
          "name": "entry.country",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 runtime probe includes code 61 frame and validates typed user-list payload schema support."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 authenticated probe includes code 61 frame with typed user-list schema layout."
        }
      ]
    },
    {
      "scope": "server",
      "code": 62,
      "name": "SM_ROOM_ADDED",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-text-control/official_frames.hex",
          "note": "Authenticated runtime flow sends room-added control frame (code 62) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 63,
      "name": "SM_ROOM_REMOVED",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-text-control/official_frames.hex",
          "note": "Authenticated runtime flow sends room-removed control frame (code 63) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 64,
      "name": "SM_ROOM_LIST",
      "payload": [
        {
          "name": "room_count",
          "type": "u32"
        },
        {
          "name": "rooms",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-room-list/official_frames.hex",
          "note": "Observed runtime room list request/response flow with authenticated session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 65,
      "name": "SM_EXACT_FILE_SEARCH",
      "payload": [
        {
          "name": "virtual_path",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search/official_frames.hex",
          "note": "Observed outbound runtime frame in login-search scenario (code 65) with exact virtual path payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 66,
      "name": "SM_ADMIN_MESSAGE",
      "payload": [
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-text-control/official_frames.hex",
          "note": "Authenticated runtime flow sends admin-message control frame (code 66) with message string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 67,
      "name": "SM_GLOBAL_USER_LIST",
      "payload": [
        {
          "name": "user_count",
          "type": "u32"
        },
        {
          "name": "entry.username",
          "type": "string"
        },
        {
          "name": "status_count",
          "type": "u32"
        },
        {
          "name": "entry.status",
          "type": "u32"
        },
        {
          "name": "stats_count",
          "type": "u32"
        },
        {
          "name": "entry.avg_speed",
          "type": "u32"
        },
        {
          "name": "entry.upload_num",
          "type": "u32"
        },
        {
          "name": "entry.unknown",
          "type": "u32"
        },
        {
          "name": "entry.files",
          "type": "u32"
        },
        {
          "name": "entry.dirs",
          "type": "u32"
        },
        {
          "name": "slots_count",
          "type": "u32"
        },
        {
          "name": "entry.slots_full",
          "type": "u32"
        },
        {
          "name": "country_count",
          "type": "u32"
        },
        {
          "name": "entry.country",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 runtime probe captures typed global-user-list payload activity (request/response multiplexing on code 67)."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class GlobalUserList (code 67) parses UsersMessage list payload layout."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 authenticated probe includes code 67 request/response activity."
        }
      ]
    },
    {
      "scope": "server",
      "code": 68,
      "name": "SM_PEER_MESSAGE",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "code",
          "type": "u32"
        },
        {
          "name": "ip_address",
          "type": "ipv4_u32_le"
        },
        {
          "name": "port",
          "type": "u32"
        },
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-message/official_frames.hex",
          "note": "Deterministic runtime-local legacy tunneled-message capture covers code 68 request/response payload variants; alt compatibility alias 292 observed in same run."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 68 is documented as PeerMessage/TunneledMessage in protocol references."
        }
      ]
    },
    {
      "scope": "server",
      "code": 69,
      "name": "SM_PRIVILEGED_LIST",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes privileged-list request and response frames (code 69) with user-list style payloads."
        }
      ]
    },
    {
      "scope": "server",
      "code": 70,
      "name": "SM_CONNECT_TO_CLIENT",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "connection_type",
          "type": "string"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 runtime probe captures typed connect-to-client payload with token+username+connection_type fields."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch1-control/official_frames.hex",
          "note": "S6 batch-1 authenticated probe includes code 70 frame with token+username+connection_type payload shape."
        }
      ]
    },
    {
      "scope": "server",
      "code": 71,
      "name": "SM_SEND_DISTRIBUTIONS",
      "payload": [
        {
          "name": "no_parent",
          "type": "bool_u8"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 runtime probe captures typed no-parent bool control payload on code 71."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class HaveNoParent (code 71) serializes one bool payload flag."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 authenticated probe includes code 71 bool payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 73,
      "name": "SM_NOTE_PARENT",
      "payload": [
        {
          "name": "parent_ip",
          "type": "ipv4_u32_reversed"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 runtime probe captures typed reversed-IPv4 parent note payload on code 73."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class ParentIP (code 73) uses reversed IPv4 u32 payload representation."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 authenticated probe includes code 73 payload with reversed IPv4 encoding."
        }
      ]
    },
    {
      "scope": "server",
      "code": 82,
      "name": "SM_CHILD_PARENT_MAP",
      "payload": [
        {
          "name": "entry_count",
          "type": "u32"
        },
        {
          "name": "entry.child_username",
          "type": "string"
        },
        {
          "name": "entry.parent_username",
          "type": "string"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 runtime probe captures typed child-parent map payload on code 82 with compatibility raw tail."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 authenticated probe includes code 82 payload with typed child->parent pair entries and raw-tail compatibility."
        }
      ]
    },
    {
      "scope": "server",
      "code": 83,
      "name": "SM_SET_PARENT_MIN_SPEED",
      "payload": [
        {
          "name": "min_speed",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-distributed-control/official_frames.hex",
          "note": "Authenticated runtime flow observes server-issued parent min speed tuning frame (code 83) with typed `u32` payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 84,
      "name": "SM_SET_PARENT_SPEED_CONNECTION_RATIO",
      "payload": [
        {
          "name": "ratio",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-distributed-control/official_frames.hex",
          "note": "Authenticated runtime flow observes server-issued parent speed ratio tuning frame (code 84) with typed `u32` payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 86,
      "name": "SM_SET_PARENT_INACTIVITY_BEFORE_DISCONNECT",
      "payload": [
        {
          "name": "seconds",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-disconnect-control/official_frames.hex",
          "note": "Authenticated runtime flow sends parent-inactivity control frame (code 86) with u32 seconds payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 87,
      "name": "SM_SET_SERVER_INACTIVITY_BEFORE_DISCONNECT",
      "payload": [
        {
          "name": "seconds",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-disconnect-control/official_frames.hex",
          "note": "Authenticated runtime flow sends server-inactivity control frame (code 87) with u32 seconds payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 88,
      "name": "SM_NODES_IN_CACHE_BEFORE_DISCONNECT",
      "payload": [
        {
          "name": "nodes",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-disconnect-control/official_frames.hex",
          "note": "Authenticated runtime flow sends nodes-in-cache control frame (code 88) with u32 nodes payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 90,
      "name": "SM_SET_SECONDS_BEFORE_PING_CHILDREN",
      "payload": [
        {
          "name": "seconds",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-disconnect-control/official_frames.hex",
          "note": "Authenticated runtime flow sends ping-children control frame (code 90) with u32 seconds payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 91,
      "name": "SM_ADD_PRIVILEGED_USER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 91 to SM_ADD_PRIVILEGED_USER (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 92,
      "name": "SM_GET_OWN_PRIVILEGES_STATUS",
      "payload": [
        {
          "name": "time_left_seconds",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends own-privileges status request (code 92); spec defines CheckPrivileges response with remaining seconds."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GET_OWN_PRIVILEGES_STATUS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 92 documents CheckPrivileges with response payload indicating remaining seconds."
        }
      ]
    },
    {
      "scope": "server",
      "code": 93,
      "name": "SM_DNET_MESSAGE",
      "payload": [
        {
          "name": "distrib_code",
          "type": "u8"
        },
        {
          "name": "distrib_payload",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 runtime probe captures typed distributed embedded message payload on code 93."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class EmbeddedMessage (code 93) parses u8 distributed code followed by embedded payload bytes."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 authenticated probe includes code 93 payload with typed distributed code and bytes."
        }
      ]
    },
    {
      "scope": "server",
      "code": 100,
      "name": "SM_CAN_PARENT",
      "payload": [
        {
          "name": "can_parent",
          "type": "bool_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-disconnect-control/official_frames.hex",
          "note": "Authenticated runtime flow sends can-parent control frame (code 100) with bool_u32 payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 102,
      "name": "SM_POSSIBLE_PARENTS",
      "payload": [
        {
          "name": "parent_count",
          "type": "u32"
        },
        {
          "name": "entry.username",
          "type": "string"
        },
        {
          "name": "entry.ip_address",
          "type": "ipv4_u32_reversed"
        },
        {
          "name": "entry.port",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 runtime probe captures typed possible-parents candidate list payload on code 102."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class PossibleParents (code 102) parses username + ip + port candidate tuples."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch2-control/official_frames.hex",
          "note": "S6 batch-2 authenticated probe includes code 102 candidate list payload shape."
        }
      ]
    },
    {
      "scope": "server",
      "code": 103,
      "name": "SM_LOW_PRIORITY_FILE_SEARCH",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 103 to SM_LOW_PRIORITY_FILE_SEARCH (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 104,
      "name": "SM_WISHLIST_WAIT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 104 to SM_WISHLIST_WAIT (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 110,
      "name": "SM_GET_RECOMMENDED_USERS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes code 110 request/response for similar users with scored user entries."
        }
      ]
    },
    {
      "scope": "server",
      "code": 111,
      "name": "SM_GET_TERM_RECOMMENDATIONS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes code 111 request with term payload and recommendation-entry response."
        }
      ]
    },
    {
      "scope": "server",
      "code": 112,
      "name": "SM_GET_RECOMMENDATION_USERS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes code 112 request with term payload and scored-user response entries."
        }
      ]
    },
    {
      "scope": "server",
      "code": 113,
      "name": "SM_GET_ROOM_TICKER",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "ticker_count",
          "type": "u32"
        },
        {
          "name": "entry.username",
          "type": "string"
        },
        {
          "name": "entry.ticker",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-distributed-control/official_frames.hex",
          "note": "Authenticated runtime flow captures request+response multiplexing on code 113 and validates typed room ticker payload decoding."
        }
      ]
    },
    {
      "scope": "server",
      "code": 114,
      "name": "SM_ROOM_TICKER_USER_ADDED",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "ticker",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe captures typed room-ticker-added payload (room+username+ticker) on code 114."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class RoomTickerAdded (code 114) parses room+user+ticker strings."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe includes code 114 payload for typed ticker-added decode."
        }
      ]
    },
    {
      "scope": "server",
      "code": 115,
      "name": "SM_ROOM_TICKER_USER_REMOVED",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe captures attempted room-ticker-removed outbound payload shape on code 115 under server reset constraints."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class RoomTickerRemoved (code 115) parses room+user strings."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe includes attempted code 115 outbound payload while server resets were observed."
        }
      ]
    },
    {
      "scope": "server",
      "code": 116,
      "name": "SM_SET_TICKER",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "ticker",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe captures attempted set-ticker outbound payload shape (room+ticker) on code 116 under server reset constraints."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class SetRoomTicker (code 116) serializes room+ticker strings."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe includes attempted code 116 outbound payload while server resets were observed."
        }
      ]
    },
    {
      "scope": "server",
      "code": 117,
      "name": "SM_ADD_HATE_TERM",
      "payload": [
        {
          "name": "term",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-text-control/official_frames.hex",
          "note": "Authenticated runtime flow sends add-hate-term control frame (code 117) with term string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 118,
      "name": "SM_REMOVE_HATE_TERM",
      "payload": [
        {
          "name": "term",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-text-control/official_frames.hex",
          "note": "Authenticated runtime flow sends remove-hate-term control frame (code 118) with term string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 120,
      "name": "SM_SEARCH_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "search_text",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search/official_frames.hex",
          "note": "Observed outbound runtime frame in login-search scenario (code 120) with room+query payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 121,
      "name": "SM_UPLOAD_SPEED",
      "payload": [
        {
          "name": "bytes_per_sec",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-distributed-control/official_frames.hex",
          "note": "Authenticated runtime flow sends upload-speed control frame (code 121) with typed `bytes_per_sec` payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 122,
      "name": "SM_GET_USER_PRIVILEGES_STATUS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "privileged",
          "type": "bool_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-parent-distributed-control/official_frames.hex",
          "note": "Authenticated runtime flow captures both request and response on code 122 with typed `username + privileged` semantics."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GET_USER_PRIVILEGES_STATUS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 122 documents UserPrivileged (deprecated) with username and bool response fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 123,
      "name": "SM_GIVE_PRIVILEGE",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "days",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends give-privilege request (code 123) with username+days payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GIVE_PRIVILEGE."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 123 documents GivePrivileges with username and number of days."
        }
      ]
    },
    {
      "scope": "server",
      "code": 124,
      "name": "SM_INFORM_USER_OF_PRIVILEGES",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends notify-privileges request (code 124) with token+username payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_INFORM_USER_OF_PRIVILEGES."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 124 documents NotifyPrivileges with token and username."
        }
      ]
    },
    {
      "scope": "server",
      "code": 125,
      "name": "SM_INFORM_USER_OF_PRIVILEGES_ACK",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends notify-privileges ack (code 125) with token payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_INFORM_USER_OF_PRIVILEGES_ACK."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 125 documents AckNotifyPrivileges with token payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 126,
      "name": "SM_DNET_LEVEL",
      "payload": [
        {
          "name": "level",
          "type": "optional_u32"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E runtime+spec evidence confirms BranchLevel layout on code 126 (u32 level with optional residual tail)."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class BranchLevel (code 126) serializes one u32 branch-level value."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 126 frame with u32 payload and no residual tail."
        }
      ]
    },
    {
      "scope": "server",
      "code": 127,
      "name": "SM_DNET_GROUP_LEADER",
      "payload": [
        {
          "name": "username",
          "type": "optional_string"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E runtime+spec evidence confirms BranchRoot layout on code 127 (string root username with optional residual tail)."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class BranchRoot (code 127) serializes one root-username string."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 127 frame with root-username string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 128,
      "name": "SM_DNET_DELIVERY_REPORT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E runtime probe confirms active code 128 wire path (4-byte payload observed); semantics remain unresolved and decoder stays dedicated-opaque."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 128 with 4-byte payload; semantics remain unresolved and stay dedicated opaque."
        }
      ]
    },
    {
      "scope": "server",
      "code": 129,
      "name": "SM_DNET_CHILD_DEPTH",
      "payload": [
        {
          "name": "depth",
          "type": "optional_u32"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E runtime+spec evidence confirms ChildDepth layout on code 129 (u32 depth with optional residual tail)."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class ChildDepth (code 129) serializes one u32 depth value."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 129 frame with u32 depth payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 130,
      "name": "SM_DNET_RESET",
      "payload": [
        {
          "name": "reason",
          "type": "optional_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-system-control/official_frames.hex",
          "note": "Authenticated runtime flow sends dnet-reset control frame (code 130) with u32 reason payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 131,
      "name": "SM_FLOOD",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E runtime probe confirms active code 131 wire path (4-byte payload observed); semantics remain unresolved and decoder stays dedicated-opaque."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-distributed-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 131 with 4-byte payload; semantics remain unresolved and stay dedicated opaque."
        }
      ]
    },
    {
      "scope": "server",
      "code": 132,
      "name": "SM_BAN_USER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 132 to SM_BAN_USER (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 133,
      "name": "SM_ROOM_MEMBERS",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "users",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime room-members request flow in authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 134,
      "name": "SM_ADD_ROOM_MEMBER",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 134 AddUserToPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_ADD_ROOM_MEMBER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 134 documents AddUserToPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 135,
      "name": "SM_REMOVE_ROOM_MEMBER",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 135 RemoveUserFromPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_REMOVE_ROOM_MEMBER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 135 documents RemoveUserFromPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 136,
      "name": "SM_REMOVE_OWN_ROOM_MEMBERSHIP",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-room-membership-control/official_frames.hex",
          "note": "Authenticated runtime flow sends remove-own-room-membership control frame (code 136) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 137,
      "name": "SM_GIVE_UP_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-room-membership-control/official_frames.hex",
          "note": "Authenticated runtime flow sends give-up-room control frame (code 137) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 138,
      "name": "SM_TRANSFER_ROOM_OWNERSHIP",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe captures attempted transfer-room-ownership outbound payload shape (room) on code 138 under server reset constraints."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class RoomSomething (code 138, obsolete) uses room string payload."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe includes attempted code 138 outbound payload while server resets were observed."
        }
      ]
    },
    {
      "scope": "server",
      "code": 139,
      "name": "SM_ADD_ROOM_MEMBERSHIP",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-room-membership-control/official_frames.hex",
          "note": "Authenticated runtime flow sends add-room-membership control frame (code 139) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 140,
      "name": "SM_REMOVE_ROOM_MEMBERSHIP",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-room-membership-control/official_frames.hex",
          "note": "Authenticated runtime flow sends remove-room-membership control frame (code 140) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 141,
      "name": "SM_ENABLE_PRIVATE_ROOM_ADD",
      "payload": [
        {
          "name": "enabled",
          "type": "bool_u8"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe captures attempted enable-private-room-add bool payload shape on code 141 under server reset constraints."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class EnableRoomInvitations (code 141) serializes a bool flag payload."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe includes attempted code 141 outbound payload while server resets were observed."
        }
      ]
    },
    {
      "scope": "server",
      "code": 142,
      "name": "SM_CHANGE_PASSWORD",
      "payload": [
        {
          "name": "password",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe captures attempted change-password string payload shape on code 142 under server reset constraints."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class ChangePassword (code 142) serializes one password string payload."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-s6-batch3-control/official_frames.hex",
          "note": "S6 batch-3 probe includes attempted code 142 outbound payload while server resets were observed."
        }
      ]
    },
    {
      "scope": "server",
      "code": 143,
      "name": "SM_ADD_ROOM_OPERATOR",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 143 AddOperatorToPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_ADD_ROOM_OPERATOR."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 143 documents AddOperatorToPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 144,
      "name": "SM_REMOVE_ROOM_OPERATOR",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 144 RemoveOperatorFromPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_REMOVE_ROOM_OPERATOR."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 144 documents RemoveOperatorFromPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 145,
      "name": "SM_ADD_ROOM_OPERATORSHIP",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-room-membership-control/official_frames.hex",
          "note": "Authenticated runtime flow sends add-room-operatorship control frame (code 145) with room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 146,
      "name": "SM_REMOVE_ROOM_OPERATORSHIP",
      "payload": [
        {
          "name": "room",
          "type": "optional_string"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-room-operatorship-control/official_frames.hex",
          "note": "S6E runtime+spec evidence confirms room-string payload on code 146 for room operatorship revocation."
        },
        {
          "kind": "spec",
          "source": "https://raw.githubusercontent.com/nicotine-plus/nicotine-plus/master/pynicotine/slskmessages.py",
          "note": "Nicotine+ class RoomOperatorshipRevoked (code 146) parses room string payload."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-room-operatorship-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 146 with len-prefixed room string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 147,
      "name": "SM_REMOVE_OWN_ROOM_OPERATORSHIP",
      "payload": [
        {
          "name": "room",
          "type": "optional_string"
        },
        {
          "name": "raw_tail",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-room-operatorship-control/official_frames.hex",
          "note": "S6E runtime evidence confirms room-string wire layout on code 147 (same layout family as code 146)."
        },
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-legacy-room-operatorship-control/official_frames.hex",
          "note": "S6E authenticated runtime probe includes code 147 with same room-string wire layout used by code 146."
        }
      ]
    },
    {
      "scope": "server",
      "code": 148,
      "name": "SM_ROOM_OPERATORS",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "operators",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime room-operators request flow in authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 149,
      "name": "SM_MESSAGE_USERS",
      "payload": [
        {
          "name": "username_count",
          "type": "u32"
        },
        {
          "name": "usernames",
          "type": "array<string>"
        },
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-message-users/official_frames.hex",
          "note": "Authenticated runtime flow sends message-users payload (code 149) with user list and message body."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 149 documents SendMessageUsers payload (users list + message)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 150,
      "name": "SM_JOIN_GLOBAL_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "optional_string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-global-room-control/official_frames.hex",
          "note": "Authenticated runtime flow sends join-global-room control frame (code 150) with empty payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 151,
      "name": "SM_LEAVE_GLOBAL_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "optional_string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-global-room-control/official_frames.hex",
          "note": "Authenticated runtime flow sends leave-global-room control frame (code 151) with empty payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 152,
      "name": "SM_SAY_GLOBAL_ROOM",
      "payload": [
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-global-room-control/official_frames.hex",
          "note": "Authenticated runtime flow sends say-global-room control frame (code 152) with message string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 153,
      "name": "SM_SEARCH_CORRELATIONS",
      "payload": [
        {
          "name": "term",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-global-room-control/official_frames.hex",
          "note": "Authenticated runtime flow sends search-correlations control frame (code 153) with term string payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 292,
      "name": "SM_PEER_MESSAGE_ALT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-message/official_frames.hex",
          "note": "Observed runtime alias code 292 for peer message tunneling in login-peer-message flow."
        }
      ]
    }
  ]
}
