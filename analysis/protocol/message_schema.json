{
  "version": 2,
  "generated_at": "2026-02-14T20:04:03+00:00",
  "framing": {
    "transport": "tcp",
    "layout": "<u32 frame_len_le><u32 message_code_le><payload>",
    "confidence": "medium",
    "evidence": [
      {
        "kind": "ghidra_decompile",
        "source": "evidence/reverse/disasm/server_send_message.txt",
        "note": "Server send path serializes integer fields through MemStream before socket write."
      },
      {
        "kind": "ghidra_decompile",
        "source": "evidence/reverse/disasm/peer_send_message.txt",
        "note": "Peer send path mirrors frame serialization through MemStream."
      }
    ]
  },
  "coverage_contract": {
    "target_core_messages": 25,
    "high_min": 18,
    "medium_max": 7,
    "low_max": 0,
    "current": {
      "high": 25,
      "medium": 0,
      "low": 0
    }
  },
  "messages": [
    {
      "scope": "peer",
      "code": 4,
      "name": "PM_GET_SHARED_FILE_LIST",
      "payload": [
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 5,
      "name": "PM_SHARED_FILE_LIST",
      "payload": [
        {
          "name": "entries",
          "type": "array<shared_file_entry>"
        },
        {
          "name": "entry.virtual_path",
          "type": "string"
        },
        {
          "name": "entry.size",
          "type": "u64"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 8,
      "name": "PM_FILE_SEARCH_REQUEST",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "query",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 9,
      "name": "PM_FILE_SEARCH_RESULT",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "result_count",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search-download/official_frames.hex",
          "note": "Observed inbound runtime frame in login-search-download scenario (code 9) with token+user+result_count."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 10,
      "name": "PM_INVITE_USER_TO_ROOM",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits invite-to-room frame (code 10) with room payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 14,
      "name": "PM_CANCELLED_QUEUED_TRANSFER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits cancelled-queued-transfer frame (code 14) with virtual path payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 15,
      "name": "PM_USER_INFO_REQUEST",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer code 15 UserInfoRequest with empty payload (code resolved from SLSK protocol spec); symbol confirmed in peer message code table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_USER_INFO_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 15 documents user info request as empty payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 16,
      "name": "PM_USER_INFO_REPLY",
      "payload": [
        {
          "name": "description",
          "type": "string"
        },
        {
          "name": "has_picture",
          "type": "bool_u8"
        },
        {
          "name": "picture",
          "type": "bytes_len_prefixed"
        },
        {
          "name": "total_uploads",
          "type": "u32"
        },
        {
          "name": "queue_size",
          "type": "u32"
        },
        {
          "name": "slots_free",
          "type": "bool_u8"
        },
        {
          "name": "upload_permissions",
          "type": "optional_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer code 16 UserInfoReply with description/picture/uploads/queue/slots fields (code resolved from SLSK protocol spec); symbol confirmed in peer message code table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_USER_INFO_REPLY."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 16 documents user info reply payload fields."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 34,
      "name": "PM_MOVE_DOWNLOAD_TO_TOP",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits move-download-to-top frame (code 34) with virtual path payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 36,
      "name": "PM_GET_SHARED_FILES_IN_FOLDER",
      "payload": [
        {
          "name": "directory",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-folder-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow sends request for shared files in folder (code 36) with directory payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_GET_SHARED_FILES_IN_FOLDER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 36 documents folder contents request with directory string payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 37,
      "name": "PM_SHARED_FILES_IN_FOLDER",
      "payload": [
        {
          "name": "directory",
          "type": "string"
        },
        {
          "name": "compressed_listing",
          "type": "bytes_raw"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-folder-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits shared-files-in-folder response (code 37) with directory plus compressed listing bytes."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_SHARED_FILES_IN_FOLDER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 37 documents compressed folder listing response payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 40,
      "name": "PM_TRANSFER_REQUEST",
      "payload": [
        {
          "name": "direction",
          "type": "enum_u32"
        },
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "file_size",
          "type": "u64"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer request negotiation."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer request negotiation path."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 41,
      "name": "PM_TRANSFER_RESPONSE",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "allowed",
          "type": "bool_u32"
        },
        {
          "name": "queue_or_reason",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer response negotiation."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_file_request.txt",
          "note": "Transfer queue dispatcher handles transfer response negotiation path."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 43,
      "name": "PM_QUEUE_UPLOAD",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Observed literal in PeerMessenger::MessageCodeToString dispatch."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/transfer_on_queue_download.txt",
          "note": "Queue manager records upload queueing for pending peers."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 44,
      "name": "PM_UPLOAD_PLACE_IN_LINE",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "place",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/upload-deny/official_frames.hex",
          "note": "Observed inbound runtime frame in upload-deny scenario (code 44) with queue place payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 46,
      "name": "PM_UPLOAD_FAILED",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "reason",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/upload-deny/official_frames.hex",
          "note": "Observed inbound runtime frame in upload-deny scenario (code 46) with failure reason payload."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/upload_write_socket.txt",
          "note": "Upload send path emits failure branch when transfer cannot continue."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 47,
      "name": "PM_EXACT_FILE_SEARCH_REQUEST",
      "payload": [
        {
          "name": "token",
          "type": "optional_u32"
        },
        {
          "name": "query",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits exact-file-search frame (code 47) with token+query payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_EXACT_FILE_SEARCH_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code list includes code 47 for ExactFileSearchRequest (legacy/obsolete family)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 48,
      "name": "PM_QUEUED_DOWNLOADS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits queued-downloads frame (code 48) with list payload."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 49,
      "name": "PM_INDIRECT_FILE_SEARCH_REQUEST",
      "payload": [
        {
          "name": "token",
          "type": "optional_u32"
        },
        {
          "name": "query",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/peer-legacy-local/official_frames.hex",
          "note": "Deterministic peer-local runtime flow emits indirect-file-search frame (code 49) with query payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_INDIRECT_FILE_SEARCH_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code list includes code 49 for IndirectFileSearchRequest (legacy/obsolete family)."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 50,
      "name": "PM_UPLOAD_DENIED",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "virtual_path",
          "type": "string"
        },
        {
          "name": "reason",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/upload-deny/official_frames.hex",
          "note": "Observed inbound runtime frame in upload-deny scenario (code 50) with deny reason payload."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/upload_write_socket.txt",
          "note": "Upload send path emits deny branch for rejected requests."
        }
      ]
    },
    {
      "scope": "peer",
      "code": 51,
      "name": "PM_UPLOAD_PLACE_IN_LINE_REQUEST",
      "payload": [
        {
          "name": "virtual_path",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer code 51 PlaceInQueueRequest with filename/path payload (code resolved from SLSK protocol spec); symbol confirmed in peer message code table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/peer_messagecodetostring_otool.txt",
          "note": "Peer MessageCodeToString includes PM_UPLOAD_PLACE_IN_LINE_REQUEST."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Peer code 51 documents place-in-line request carrying filename/path."
        }
      ]
    },
    {
      "scope": "server",
      "code": 1,
      "name": "SM_LOGIN",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "password",
          "type": "string"
        },
        {
          "name": "client_version",
          "type": "u32"
        },
        {
          "name": "md5hash",
          "type": "string"
        },
        {
          "name": "minor_version",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-only/official_frames.hex",
          "note": "Observed authenticated runtime login request+response (code 1) with success payload on tuple 160/1."
        }
      ]
    },
    {
      "scope": "server",
      "code": 2,
      "name": "SM_SET_WAIT_PORT",
      "payload": [
        {
          "name": "listen_port",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Observed literal in Server::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "server",
      "code": 3,
      "name": "SM_GET_PEER_ADDRESS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "ip_address",
          "type": "ipv4_u32_le"
        },
        {
          "name": "port",
          "type": "u32"
        },
        {
          "name": "obfuscation_type",
          "type": "u32"
        },
        {
          "name": "obfuscated_port",
          "type": "u16"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-address-connect/official_frames.hex",
          "note": "Authenticated runtime flow includes GetPeerAddress request/response (code 3) with username and endpoint payload fields."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 3 defines peer-address request and response payload fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 7,
      "name": "SM_GET_USER_STATUS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "status",
          "type": "u32"
        },
        {
          "name": "privileged",
          "type": "bool_u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-user-state/official_frames.hex",
          "note": "Authenticated runtime flow includes user-status request/response (code 7) with status and privilege fields."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 7 defines user status response fields (status and privilege bit)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 11,
      "name": "SM_IGNORE_USER",
      "payload": [
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends ignore-user request (code 11); mapping aligns with server MessageCodeToString and SLSK spec obsolete ignore operation."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_IGNORE_USER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 11 documents IgnoreUser (obsolete) with username payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 12,
      "name": "SM_UNIGNORE_USER",
      "payload": [
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends unignore-user request (code 12); mapping aligns with server MessageCodeToString and SLSK spec obsolete unignore operation."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_UNIGNORE_USER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 12 documents UnignoreUser (obsolete) with username payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 13,
      "name": "SM_SAY_CHATROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "optional_string"
        },
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime room message flow: outbound SAY request and inbound room chat event in authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 14,
      "name": "SM_JOIN_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "users",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime join-room request and server join payload during authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 15,
      "name": "SM_LEAVE_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-leave-room/official_frames.hex",
          "note": "Observed runtime leave-room request and server leave acknowledgement payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 16,
      "name": "SM_USER_JOINED_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime user-joined room presence events while watching authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 17,
      "name": "SM_USER_LEFT_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime user-left room presence events while watching authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 18,
      "name": "SM_CONNECT_TO_PEER",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "connection_type",
          "type": "string"
        },
        {
          "name": "ip_address",
          "type": "ipv4_u32_le"
        },
        {
          "name": "port",
          "type": "u32"
        },
        {
          "name": "privileged",
          "type": "bool_u32"
        },
        {
          "name": "obfuscation_type",
          "type": "u32"
        },
        {
          "name": "obfuscated_port",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-address-connect/official_frames.hex",
          "note": "Authenticated runtime flow includes ConnectToPeer request and response payloads (code 18) with token"
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_handle_message.txt",
          "note": "Server handler routes peer connect responses to transfer subsystem."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 18 documents ConnectToPeer request and response payload shape."
        }
      ]
    },
    {
      "scope": "server",
      "code": 22,
      "name": "SM_MESSAGE_USER",
      "payload": [
        {
          "name": "message_id",
          "type": "u32"
        },
        {
          "name": "timestamp",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "message",
          "type": "string"
        },
        {
          "name": "is_new",
          "type": "bool_u8"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-message/official_frames.hex",
          "note": "Authenticated runtime flow includes private-message send and inbound private-message frame (code 22) with directional payload variants."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 22 documents private message request and incoming event fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 23,
      "name": "SM_MESSAGE_ACKED",
      "payload": [
        {
          "name": "message_id",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-private-message/official_frames.hex",
          "note": "Authenticated runtime flow includes private-message acknowledgement path (code 23) with message_id payload."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 23 documents private message acknowledgement with message ID."
        }
      ]
    },
    {
      "scope": "server",
      "code": 26,
      "name": "SM_FILE_SEARCH",
      "payload": [
        {
          "name": "search_token",
          "type": "u32"
        },
        {
          "name": "search_text",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_file_search.txt",
          "note": "FileSearch writes constant 0x1a before Server::SendMessage."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_file_search.txt",
          "note": "Function writes constant 0x1a before serializing search payload."
        },
        {
          "kind": "ghidra_decompile",
          "source": "evidence/reverse/disasm/server_prepare_search.txt",
          "note": "PrepareSearch normalizes and emits search tokens/strings."
        }
      ]
    },
    {
      "scope": "server",
      "code": 34,
      "name": "SM_DOWNLOAD_SPEED",
      "payload": [
        {
          "name": "bytes_per_sec",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Observed literal in Server::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "server",
      "code": 35,
      "name": "SM_SHARED_FOLDERS_FILES",
      "payload": [
        {
          "name": "folder_count",
          "type": "u32"
        },
        {
          "name": "file_count",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Observed literal in Server::MessageCodeToString dispatch."
        }
      ]
    },
    {
      "scope": "server",
      "code": 36,
      "name": "SM_GET_USER_STATS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "avg_speed",
          "type": "u32"
        },
        {
          "name": "download_num",
          "type": "u32"
        },
        {
          "name": "files",
          "type": "u32"
        },
        {
          "name": "dirs",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-user-state/official_frames.hex",
          "note": "Authenticated runtime flow includes user-stats request/response (code 36) with stats summary fields."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 36 defines user stats response fields (speed/downloads/files/dirs)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 42,
      "name": "SM_SEARCH_USER_FILES",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "search_text",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search/official_frames.hex",
          "note": "Observed outbound runtime frame in login-search scenario (code 42) with user+query payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 50,
      "name": "SM_GET_SIMILAR_TERMS",
      "payload": [
        {
          "name": "term",
          "type": "string"
        },
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-similar-terms/official_frames.hex",
          "note": "Observed authenticated runtime request/response for similar-terms discovery flow (code 50)."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GET_SIMILAR_TERMS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents similar recommendation request/response message family."
        }
      ]
    },
    {
      "scope": "server",
      "code": 54,
      "name": "SM_GET_RECOMMENDATIONS",
      "payload": [
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-recommendations/official_frames.hex",
          "note": "Observed authenticated runtime recommendations flow (code 54) including outbound request and inbound summary payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents recommendation request/response code mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 55,
      "name": "SM_GET_MY_RECOMMENDATIONS",
      "payload": [
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-recommendations/official_frames.hex",
          "note": "Observed outbound authenticated runtime request for my-recommendations (code 55) in recommendation batch."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_MY_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents my-recommendations request code mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 56,
      "name": "SM_GET_GLOBAL_RECOMMENDATIONS",
      "payload": [
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-recommendations/official_frames.hex",
          "note": "Observed authenticated runtime global-recommendations flow (code 56) with populated inbound payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_GLOBAL_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents global recommendations message mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 57,
      "name": "SM_GET_USER_RECOMMENDATIONS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "recommendation_count",
          "type": "u32"
        },
        {
          "name": "recommendation.term",
          "type": "string"
        },
        {
          "name": "recommendation.score",
          "type": "i32"
        },
        {
          "name": "unrecommendation_count",
          "type": "u32"
        },
        {
          "name": "unrecommendation.term",
          "type": "string"
        },
        {
          "name": "unrecommendation.score",
          "type": "i32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-user-recommendations/official_frames.hex",
          "note": "Observed authenticated runtime user-recommendations flow (code 57) with user request and reply payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/server_messagecodetostring_otool.txt",
          "note": "Server MessageCodeToString includes SM_GET_USER_RECOMMENDATIONS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Protocol list documents user recommendation/interests message mapping."
        }
      ]
    },
    {
      "scope": "server",
      "code": 58,
      "name": "SM_COMMAND",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 58 to SM_COMMAND (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 64,
      "name": "SM_ROOM_LIST",
      "payload": [
        {
          "name": "room_count",
          "type": "u32"
        },
        {
          "name": "rooms",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-room-list/official_frames.hex",
          "note": "Observed runtime room list request/response flow with authenticated session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 65,
      "name": "SM_EXACT_FILE_SEARCH",
      "payload": [
        {
          "name": "virtual_path",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search/official_frames.hex",
          "note": "Observed outbound runtime frame in login-search scenario (code 65) with exact virtual path payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 66,
      "name": "SM_ADMIN_MESSAGE",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 66 to SM_ADMIN_MESSAGE (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 67,
      "name": "SM_GLOBAL_USER_LIST",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 67 to SM_GLOBAL_USER_LIST (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 68,
      "name": "SM_PEER_MESSAGE",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "code",
          "type": "u32"
        },
        {
          "name": "ip_address",
          "type": "ipv4_u32_le"
        },
        {
          "name": "port",
          "type": "u32"
        },
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-peer-message/official_frames.hex",
          "note": "Deterministic runtime-local legacy tunneled-message capture covers code 68 request/response payload variants; alt compatibility alias 292 observed in same run."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 68 is documented as PeerMessage/TunneledMessage in protocol references."
        }
      ]
    },
    {
      "scope": "server",
      "code": 69,
      "name": "SM_PRIVILEGED_LIST",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes privileged-list request and response frames (code 69) with user-list style payloads."
        }
      ]
    },
    {
      "scope": "server",
      "code": 71,
      "name": "SM_SEND_DISTRIBUTIONS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 71 to SM_SEND_DISTRIBUTIONS (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 73,
      "name": "SM_NOTE_PARENT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 73 to SM_NOTE_PARENT (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 82,
      "name": "SM_CHILD_PARENT_MAP",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 82 to SM_CHILD_PARENT_MAP (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 83,
      "name": "SM_SET_PARENT_MIN_SPEED",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 83 to SM_SET_PARENT_MIN_SPEED (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 84,
      "name": "SM_SET_PARENT_SPEED_CONNECTION_RATIO",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 84 to SM_SET_PARENT_SPEED_CONNECTION_RATIO (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 86,
      "name": "SM_SET_PARENT_INACTIVITY_BEFORE_DISCONNECT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 86 to SM_SET_PARENT_INACTIVITY_BEFORE_DISCONNECT (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 87,
      "name": "SM_SET_SERVER_INACTIVITY_BEFORE_DISCONNECT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 87 to SM_SET_SERVER_INACTIVITY_BEFORE_DISCONNECT (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 88,
      "name": "SM_NODES_IN_CACHE_BEFORE_DISCONNECT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 88 to SM_NODES_IN_CACHE_BEFORE_DISCONNECT (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 90,
      "name": "SM_SET_SECONDS_BEFORE_PING_CHILDREN",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 90 to SM_SET_SECONDS_BEFORE_PING_CHILDREN (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 92,
      "name": "SM_GET_OWN_PRIVILEGES_STATUS",
      "payload": [
        {
          "name": "time_left_seconds",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends own-privileges status request (code 92); spec defines CheckPrivileges response with remaining seconds."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GET_OWN_PRIVILEGES_STATUS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 92 documents CheckPrivileges with response payload indicating remaining seconds."
        }
      ]
    },
    {
      "scope": "server",
      "code": 93,
      "name": "SM_DNET_MESSAGE",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 93 to SM_DNET_MESSAGE (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 100,
      "name": "SM_CAN_PARENT",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 100 to SM_CAN_PARENT (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 102,
      "name": "SM_POSSIBLE_PARENTS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 102 to SM_POSSIBLE_PARENTS (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 110,
      "name": "SM_GET_RECOMMENDED_USERS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes code 110 request/response for similar users with scored user entries."
        }
      ]
    },
    {
      "scope": "server",
      "code": 111,
      "name": "SM_GET_TERM_RECOMMENDATIONS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes code 111 request with term payload and recommendation-entry response."
        }
      ]
    },
    {
      "scope": "server",
      "code": 112,
      "name": "SM_GET_RECOMMENDATION_USERS",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privilege-messaging/official_frames.hex",
          "note": "Authenticated runtime flow includes code 112 request with term payload and scored-user response entries."
        }
      ]
    },
    {
      "scope": "server",
      "code": 120,
      "name": "SM_SEARCH_ROOM",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "search_text",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-search/official_frames.hex",
          "note": "Observed outbound runtime frame in login-search scenario (code 120) with room+query payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 121,
      "name": "SM_UPLOAD_SPEED",
      "payload": [
        {
          "name": "bytes_per_sec",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "String present and mirrored by upload code paths."
        }
      ]
    },
    {
      "scope": "server",
      "code": 122,
      "name": "SM_GET_USER_PRIVILEGES_STATUS",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "privileged",
          "type": "bool_u32"
        }
      ],
      "confidence": "medium",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends user-privileges status request (code 122); response semantics are deprecated in spec and treated as username+privileged summary."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GET_USER_PRIVILEGES_STATUS."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 122 documents UserPrivileged (deprecated) with username and bool response fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 123,
      "name": "SM_GIVE_PRIVILEGE",
      "payload": [
        {
          "name": "username",
          "type": "string"
        },
        {
          "name": "days",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends give-privilege request (code 123) with username+days payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_GIVE_PRIVILEGE."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 123 documents GivePrivileges with username and number of days."
        }
      ]
    },
    {
      "scope": "server",
      "code": 124,
      "name": "SM_INFORM_USER_OF_PRIVILEGES",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends notify-privileges request (code 124) with token+username payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_INFORM_USER_OF_PRIVILEGES."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 124 documents NotifyPrivileges with token and username."
        }
      ]
    },
    {
      "scope": "server",
      "code": 125,
      "name": "SM_INFORM_USER_OF_PRIVILEGES_ACK",
      "payload": [
        {
          "name": "token",
          "type": "u32"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-privileges-social/official_frames.hex",
          "note": "Authenticated runtime flow sends notify-privileges ack (code 125) with token payload."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_INFORM_USER_OF_PRIVILEGES_ACK."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 125 documents AckNotifyPrivileges with token payload."
        }
      ]
    },
    {
      "scope": "server",
      "code": 130,
      "name": "SM_DNET_RESET",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 130 to SM_DNET_RESET (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 132,
      "name": "SM_BAN_USER",
      "payload": [],
      "confidence": "high",
      "evidence": [
        {
          "kind": "manual_note",
          "source": "evidence/reverse/message_codes_jump_table.md",
          "note": "Server MessageCodeToString jump-table extraction resolves code 132 to SM_BAN_USER (x86_64 binary disassembly)."
        }
      ]
    },
    {
      "scope": "server",
      "code": 133,
      "name": "SM_ROOM_MEMBERS",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "users",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime room-members request flow in authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 134,
      "name": "SM_ADD_ROOM_MEMBER",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 134 AddUserToPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_ADD_ROOM_MEMBER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 134 documents AddUserToPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 135,
      "name": "SM_REMOVE_ROOM_MEMBER",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 135 RemoveUserFromPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_REMOVE_ROOM_MEMBER."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 135 documents RemoveUserFromPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 143,
      "name": "SM_ADD_ROOM_OPERATOR",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 143 AddOperatorToPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_ADD_ROOM_OPERATOR."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 143 documents AddOperatorToPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 144,
      "name": "SM_REMOVE_ROOM_OPERATOR",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "username",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server code 144 RemoveOperatorFromPrivileged with room+username payload (code resolved from SLSK protocol spec) and symbol confirmed in binary string table."
        },
        {
          "kind": "string",
          "source": "evidence/reverse/message_name_strings.txt",
          "note": "Server string table includes SM_REMOVE_ROOM_OPERATOR."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 144 documents RemoveOperatorFromPrivileged operation with room+username fields."
        }
      ]
    },
    {
      "scope": "server",
      "code": 148,
      "name": "SM_ROOM_OPERATORS",
      "payload": [
        {
          "name": "room",
          "type": "string"
        },
        {
          "name": "operators",
          "type": "array<string>"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-join-room-presence/official_frames.hex",
          "note": "Observed runtime room-operators request flow in authenticated room session."
        }
      ]
    },
    {
      "scope": "server",
      "code": 149,
      "name": "SM_MESSAGE_USERS",
      "payload": [
        {
          "name": "username_count",
          "type": "u32"
        },
        {
          "name": "usernames",
          "type": "array<string>"
        },
        {
          "name": "message",
          "type": "string"
        }
      ],
      "confidence": "high",
      "evidence": [
        {
          "kind": "runtime_capture",
          "source": "captures/redacted/login-message-users/official_frames.hex",
          "note": "Authenticated runtime flow sends message-users payload (code 149) with user list and message body."
        },
        {
          "kind": "spec",
          "source": "https://nicotine-plus.org/doc/SLSKPROTOCOL.html",
          "note": "Server code 149 documents SendMessageUsers payload (users list + message)."
        }
      ]
    }
  ]
}
